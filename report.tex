\documentclass[a4paper,12pt]{article}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage[style=russian]{csquotes}
\usepackage{xcolor}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage[l3]{csvsimple}

\usepackage{cleveref}
\crefformat{equation}{(#2#1#3)}
\crefrangeformat{equation}{(#3#1#4)~-~(#5#2#6)}
\crefmultiformat{equation}{(#2#1#3)}{ и~(#2#1#3)}{, (#2#1#3)}{ и~(#2#1#3)}

\allowdisplaybreaks

\patchcmd{\thebibliography}{\section*{Список литературы}}{}{}{}

\newcommand{\UpdateMe}[1]{\textcolor{red}{#1}}
\DeclareMathOperator*{\argmax}{argmax}

\newcommand{\University}{Московский государственный университет имени М.~В.~Ломоносова}
\newcommand{\Department}{Кафедра \UpdateMe{НАЗВАНИЕ-КАФЕДРЫ}}
\newcommand{\Student}{\UpdateMe{ИМЯ-СТУДЕНТА}}
\newcommand{\GroupNum}{\UpdateMe{НОМЕР}}
\newcommand{\Seminar}{\UpdateMe{НАЗВАНИЕ-ПРАКТИКУМА}}

\begin{document}
% \begin{titlepage}
%   \centering
%   {\scshape\Large \University\par}\vspace{1cm}{\scshape\large \Department\par}
%   \vfill
%   {\huge\bfseries ОТЧЕТ\par}{\Largeпо задаче практикума \enquote{\Seminar}\par}
%   \vfill
%   \hfill\begin{minipage}{0.45\linewidth}Выполнил студент гр. \GroupNum:\\\Student\end{minipage}
%   \vfill
%   {\large Москва, \the\year{}\par}
% \end{titlepage}

\section*{Задание}
Найти решение задачи, удовлетворяющее указанным условиям ({\bfseries Задача~3.1}):
\begin{gather*}
  \frac{\partial u}{\partial t}=\alpha \frac{\partial^2 u}{\partial x^2} + u^4,\\
  \left.\frac{\partial u}{\partial x}\right\vert_{x=0}=0,\\
  \left.\frac{\partial u}{\partial x}\right\vert_{x=1}=-50u^4,\\
  \left.u\right\vert_{t=0}=\beta(1-x^2)^2,\\
  x \in [0, 1], \quad t \in [0, 1], \quad \alpha \in \{0.1, 1.0\}, \quad \beta \in \{1.0, 0.1\}
\end{gather*}
и вычислить значения следующих функционалов:
\begin{gather*}
  f_1(t) = \int_{0}^{1}{u(x, t) dx},\\
  f_2(t) = \int_{0}^{1}{u^4(x, t) dx} - 50\alpha\left.u^4\right\vert_{x=1}.
\end{gather*}

\section*{Методика решения}

Введем равномерную сетку \(\Omega=\{(x_{i}, t_{j})=(ih, j\tau): i \in 0..N-1 \quad j\in 0..M-1\}\), где \(h=1/(N-1)\) и \(\tau=1/(M-1)\).\\
Будем искать решение в виде сеточной функции, определенной в каждом узле сетки \(u(x_{i},t_{j})=u_{i}^{j}\).

\subsection*{Разностная схема}
Будем использовать схему Кранка-Николсона, которая имеет слеюущий вид:
\begin{equation}\label{scheme}
  \frac{u_{i}^{j+1}-u_{i}^{j}}{\tau}=\frac{\alpha}{2}\left(\frac{u_{i+1}^{j+1}-2u_{i}^{j+1}+u_{i-1}^{j+1}}{h^2}\right) + \frac{\alpha}{2}\left(\frac{u_{i+1}^{j}-2u_{i}^{j}+u_{i-1}^{j}}{h^2}\right) + \left(u_{i}^{j}\right)^4.
\end{equation}

\subsection*{Порядок аппроксимации}

Разложим входящие в уравнение \cref{scheme} значения сеточной функции в ряд Тейлора в точке \((x_i, t_j)\):
\begin{gather*}
  u_{i\pm1}^{j}=u(x_{i}\pm h, t_{j})=u \pm h u_x +\frac{1}{2} h^2 u_{xx} \pm \frac{1}{6} h^3 u_{xxx} + O(h^{4}),\\
  u_{i}^{j+1}=u(x_{i}, t_{j}+\tau)=u + \tau u_t +\frac{1}{2} \tau^2 u_{tt} \pm \frac{1}{6} \tau^3 u_{ttt} + O(\tau^{4}),\\
  \begin{split}
    u_{i\pm1}^{j+1}=u(x_{i}\pm h,t_{j}+\tau)=u+\tau  u_t+\frac{1}{2} \tau ^2 u_{tt}+h u_x+\frac{1}{2} h^2 u_{xx}+h \tau  u_{xt}+\frac{1}{2} h \tau ^2 u_{xtt}+\\
    +\frac{1}{2} h^2 \tau  u_{xxt}+\frac{1}{6} h^3 u_{xxx}+\frac{1}{4} h^2 \tau ^2 u_{xxtt}+\frac{1}{6} h^3 \tau  u_{xxxt}+\frac{1}{24} h^4 u_{xxxx}+\frac{1}{12} h^3 \tau ^2 u_{xxxtt}+\\
    +\frac{1}{24} h^4 \tau  u_{xxxxt}+O(h^4, \tau^2)
  \end{split}
\end{gather*}

Подставив данные выражения в \cref{scheme} получим
\begin{equation*}
  u_{t}+\frac{\tau}{2} u_{tt} = \alpha u_{xx} + \frac{\tau}{2} \alpha u_{xxt} + u^4 + O(h^2, \tau^2).
\end{equation*}
Выразив \(u_{t}\) и \(u_{tt}\) из исходного уравнения увидим, что нелинейный член не дает повысить порядок аппроксимации, который в итоге равен \(O(h^2, \tau)\).

\subsection*{Устойчивость}

Рассмотрим значения в узлах сетки как \(u_{i}^{j} = \bar{u}_{i}^{j} + \delta_{i}^{j}\), где \(\bar{u}\) - истинное решение, а \(\delta\) - ошибка. Подставим данные выражения в уравнение \cref{scheme} и рассмотрим уравнение относительно ошибок. Будучи линеаризованным оно примет вид:
\begin{equation*}
  \frac{\delta_{i}^{j+1}-\delta_{i}^{j}}{\tau}=\frac{\alpha}{2}\left(\frac{\delta_{i+1}^{j+1}-2\delta_{i}^{j+1}+\delta_{i-1}^{j+1}}{h^2}\right) + \frac{\alpha}{2}\left(\frac{\delta_{i+1}^{j}-2\delta_{i}^{j}+\delta_{i-1}^{j}}{h^2}\right) + 4\delta_{i}^{j} \left(u_{i}^{j}\right)^3.
\end{equation*}

Выполним замену \(\delta_{m}^{n}=\lambda^{n} e^{i m \phi}\), после чего поделим обе части на \(\lambda^{n} e^{i m \phi}\):
\begin{equation*}
  \frac{\lambda -1}{\tau }=4 u^3+\frac{\alpha  (\lambda +1) e^{-i \phi } \left(-1+e^{i \phi }\right)^2}{2 h^2}.
\end{equation*}
Выразив \(\lambda\) получим
\begin{equation*}
  \lambda = -1 + \frac{2 h^2 \tau \left(2 u^3+1\right)}{-\alpha  \tau  \cos (\phi )+\alpha  \tau +h^2},
\end{equation*}
то есть \(\left|\lambda\right| < 1 + O(\tau)\), и следовательно схема устойчива.

\subsection*{Система уравнений}

Выразим из уравнения \cref{scheme} неизвестные \(\delta_{*}^{j+1}\), а так же обозначим
\begin{gather*}
  A = -\frac{1}{2h^2},\\
  B_{\pm} = \frac{1}{\tau}\pm\frac{1}{h^2},\\
  C = -\frac{1}{2h^2},
\end{gather*}
что даст нам короткую запись
\begin{equation}\label{eq}
  A u_{i-1}^{j+1} + B_{+} u_{i}^{j+1} + C u_{i+1}^{j+1} = -A u_{i-1}^{j} + B_{-} u_{i}^{j} - C u_{i+1}^{j} + \left(u_{i}^{j}\right)^4 = f_{i}^{j}.
\end{equation}
Так же из граничных условий имеем:
\begin{gather}
  \label{lcond}-3 u_{0}^{j} + 4u_{1}^{j}-u_{2}^{j}=0,\\
  \label{rcond}\frac{1}{2}\mathfrak{D} u_{N-1}^{j} + \frac{1}{2}\mathfrak{D} u_{N-1}^{j+1} + 50\left(u_{N-1}^{j}\right)^4=0,
\end{gather}
где \(\mathfrak{D} u_{i}^{j}=\frac{3 u_{i}^{j} - 4u_{i-1}^{j}+u_{i-2}^{j}}{2h}\).

Окончательно (подставив \cref{lcond} в \cref{eq} при \(i=1\) и \cref{rcond} в \cref{eq} при \(i=N-2\)) получаем
\begin{align*}
   & u_{0}^{j+1} = \frac{4}{3}u_{1}^{j+1} - \frac{1}{3} u_{2}^{j+1},                                                                         \\
   & \begin{cases}
       \left(B_{+} + \frac{4}{3}A\right) u_{1}^{j+1} + \left(C - \frac{1}{3}A\right) u_{2}^{j+1} = f_{1}^{j},               \\
       A u_{i-1}^{j+1} + B_{+} u_{i}^{j+1} + C u_{i+1}^{j+1} =  f_{i}^{j}, \quad i=2..N-3,                                  \\
       \left(A - \frac{1}{3}C\right) u_{N-3}^{j+1} + \left(B_{+} + \frac{4}{3}C\right) u_{N-2}^{j+1} = \tilde{f}_{N-2}^{j}, \\
       \tilde{f}_{N-2}^{j} = f_{N-2}^{j} - C\left(\frac{1}{2}\mathfrak{D} u_{N-1}^{j} + 50\left(u_{N-1}^{j}\right)^4\right),
     \end{cases} \\
   & u_{N-1}^{j+1}= 4u_{N-2}^{j+1} - u_{N-3}^{j+1}-\frac{4h}{2}\mathfrak{D} u_{N-1}^{j+1} + 4h50\left(u_{N-1}^{j}\right)^4 
\end{align*}
Последняя система допускает решение методом прогонки, после чего из найденных значений выражаются \(u_{0}^{*}\) и \(u_{N-1}^{*}\).
\section*{Результаты}
Были рассмотрены следюущие варианты сеток: \(M=N=51\), \(M=N=101\) и \(M=N=201\).

\subsection*{Случай \(\alpha=0.1\) и \(\beta=1.0\)}

\subsubsection*{Размеры \(M=N=51\)}

\begin{tikzpicture}
  \begin{axis}[width=15cm, height=8cm, legend pos=outer north east, grid = major, grid style={dashed, gray!30}]
    \addplot [thick, mark = none, red]table [x=t, y=f1, col sep=comma] {fs_a0.1_b1.0_N51_M51.csv};
    \addlegendentry{$f_1$}
    \addplot [thick, mark = none, blue]table [x=t, y=f2, col sep=comma] {fs_a0.1_b1.0_N51_M51.csv};
    \addlegendentry{$f_2$}
  \end{axis}
\end{tikzpicture}
Ниже приведены некоторые значения функции \(u\):

\csvautotabular{u_a0.1_b1.0_N51_M51.csv}

\subsubsection*{Размеры \(M=N=101\)}

\begin{tikzpicture}
  \begin{axis}[width=15cm, height=8cm, legend pos=outer north east, grid = major, grid style={dashed, gray!30}]
    \addplot [thick, mark = none, red]table [x=t, y=f1, col sep=comma] {fs_a0.1_b1.0_N101_M101.csv};
    \addlegendentry{$f_1$}
    \addplot [thick, mark = none, blue]table [x=t, y=f2, col sep=comma] {fs_a0.1_b1.0_N101_M101.csv};
    \addlegendentry{$f_2$}
  \end{axis}
\end{tikzpicture}
Ниже приведены некоторые значения функции \(u\):

\csvautotabular{u_a0.1_b1.0_N101_M101.csv}

\subsubsection*{Размеры \(M=N=201\)}

\begin{tikzpicture}
  \begin{axis}[width=15cm, height=8cm, legend pos=outer north east, grid = major, grid style={dashed, gray!30}]
    \addplot [thick, mark = none, red]table [x=t, y=f1, col sep=comma] {fs_a0.1_b1.0_N201_M201.csv};
    \addlegendentry{$f_1$}
    \addplot [thick, mark = none, blue]table [x=t, y=f2, col sep=comma] {fs_a0.1_b1.0_N201_M201.csv};
    \addlegendentry{$f_2$}
  \end{axis}
\end{tikzpicture}
Ниже приведены некоторые значения функции \(u\):

\csvautotabular{u_a0.1_b1.0_N201_M201.csv}

\subsubsection*{Таблица отношений}
Ниже представлена таблица, с отношением значений сеточной функции при различных параметрах сеток \(\left(\frac{u_{M=101,N=101}-u_{M=51,N=51}}{u_{M=201,N=201}-u_{M=101,N=101}}\right)\):

\csvautotabular{rel_a0.1_b1.0.csv}

\subsection*{Случай \(\alpha=1.0\) и \(\beta=0.1\)}

\subsubsection*{Размеры \(M=N=51\)}

\begin{tikzpicture}
  \begin{axis}[width=15cm, height=8cm, legend pos=outer north east, grid = major, grid style={dashed, gray!30}]
    \addplot [thick, mark = none, red]table [x=t, y=f1, col sep=comma] {fs_a1.0_b0.1_N51_M51.csv};
    \addlegendentry{$f_1$}
    \addplot [thick, mark = none, blue]table [x=t, y=f2, col sep=comma] {fs_a1.0_b0.1_N51_M51.csv};
    \addlegendentry{$f_2$}
  \end{axis}
\end{tikzpicture}
Ниже приведены некоторые значения функции \(u\):

\csvautotabular{u_a1.0_b0.1_N51_M51.csv}

\subsubsection*{Размеры \(M=N=101\)}

\begin{tikzpicture}
  \begin{axis}[width=15cm, height=8cm, legend pos=outer north east, grid = major, grid style={dashed, gray!30}]
    \addplot [thick, mark = none, red]table [x=t, y=f1, col sep=comma] {fs_a1.0_b0.1_N101_M101.csv};
    \addlegendentry{$f_1$}
    \addplot [thick, mark = none, blue]table [x=t, y=f2, col sep=comma] {fs_a1.0_b0.1_N101_M101.csv};
    \addlegendentry{$f_2$}
  \end{axis}
\end{tikzpicture}
Ниже приведены некоторые значения функции \(u\):

\csvautotabular{u_a1.0_b0.1_N101_M101.csv}

\subsubsection*{Размеры \(M=N=201\)}

\begin{tikzpicture}
  \begin{axis}[width=15cm, height=8cm, legend pos=outer north east, grid = major, grid style={dashed, gray!30}]
    \addplot [thick, mark = none, red]table [x=t, y=f1, col sep=comma] {fs_a1.0_b0.1_N201_M201.csv};
    \addlegendentry{$f_1$}
    \addplot [thick, mark = none, blue]table [x=t, y=f2, col sep=comma] {fs_a1.0_b0.1_N201_M201.csv};
    \addlegendentry{$f_2$}
  \end{axis}
\end{tikzpicture}
Ниже приведены некоторые значения функции \(u\):

\csvautotabular{u_a1.0_b0.1_N201_M201.csv}

\subsubsection*{Таблица отношений}
Ниже представлена таблица, с отношением значений сеточной функции при различных параметрах сеток \(\left(\frac{u_{M=101,N=101}-u_{M=51,N=51}}{u_{M=201,N=201}-u_{M=101,N=101}}\right)\):

\csvautotabular{rel_a1.0_b0.1.csv}

% \addcontentsline{toc}{section}{Список литературы}
% \begin{thebibliography}{99}
%   \bibitem{RKM}\textbf{О.Б. Арушанян, С.Ф. Залеткин} Решение систем обыкновенных дифференциальных уравнений методами Рунге--Кутта.
%   \bibitem{TAC}\textbf{Д.П. Ким} Теория автоматического управления. Том 2.
%   \bibitem{OM}\textbf{Н.Л. Майорова, Д.В. Глазков} Методы оптимизации.
%   \bibitem{DEP}\textbf{А.Ф. Филиппов} Сборник задач по дифференциальным уравнениям.
% \end{thebibliography}
\end{document}